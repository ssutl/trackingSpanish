(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2603)}])},2603:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var s=n(5893),o=n(7294),r=n(7066);function a(){let[e,t]=o.useState(null),n=async e=>{if(!e.stsTokenManager)return!1;let t=new Date().getTime();console.log("currentTime",t);let n=t<e.stsTokenManager.expirationTime;if(n)return console.log("Token is still valid it expires at ".concat(e.stsTokenManager.expirationTime)),!0;{let e=await a();return e?(console.log("Token refreshed"),!0):(console.log("Token not refreshed"),!1)}};async function a(){let t="https://securetoken.googleapis.com/v1/token?key=".concat(e.apiKey),n={grant_type:"refresh_token",refresh_token:e.stsTokenManager.refreshToken};try{let s=await r.Z.post(t,n,{headers:{"Content-Type":"application/json"}}),o=s.data;console.log("Token refreshed",o);let a={...e};return a.stsTokenManager.accessToken=o.access_token,a.stsTokenManager.expirationTime=new Date().getTime()+1e3*o.expires_in,chrome.storage.local.set({user:a}),!0}catch(e){return console.error("Error refreshing token",e),!1}}(0,o.useEffect)(()=>{i()},[]);let i=()=>{chrome.storage.local.get(["user"],e=>{let s=e.user;s?(t(s),n(s)):console.log("User not signed in")})},c=async()=>{let e=await chrome.runtime.sendMessage({message:"sign_in"});e.success&&i()},l=async()=>{let e=await chrome.runtime.sendMessage({message:"sign_out"});e.success&&t(null)},u=async()=>{let t="https://youtu.be/f5WmYlFhW1Y?si=7OudRLAMkqbz-lev".match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/),n=t&&11===t[2].length?t[2]:null,s="https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,statistics&id=".concat(n,"&key=").concat(e.apiKey);try{let e=await r.Z.get(s);console.log("Video data",e)}catch(e){console.error("Error fetching video data",e)}};return(0,s.jsx)("div",{children:e?(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{children:["Welcome ",e.displayName]}),(0,s.jsx)("button",{onClick:e=>{e.preventDefault(),l()},children:"Sign Out"}),(0,s.jsx)("button",{onClick:u,children:"Fetch Video Data"})]}):(0,s.jsx)("button",{onClick:e=>{e.preventDefault(),c()},children:"Sign InLOOOL"})})}}},function(e){e.O(0,[66,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);
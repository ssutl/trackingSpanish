(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2603)}])},2603:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(5893),l=s(7294),n=s(2777),c=s(3977),r=s(1019),i=s(5341);let o=(0,c.ZF)({apiKey:"AIzaSyBU94yh1GICwAQbH6Sk1RvuJPrqlT4E2tA",databaseURL:"https://trackingspanish-default-rtdb.europe-west1.firebasedatabase.app"}),d=(0,r.N8)(o);function h(){let[e,t]=l.useState(null),[s,c]=l.useState(!1),[o,h]=l.useState("Stats"),[m,x]=l.useState(null);(0,l.useEffect)(()=>{u(),chrome.runtime.sendMessage({message:"POPUP_OPENED"}),chrome.windows.getCurrent(e=>{let t=e.id,s="watchingSpanish-".concat(t);chrome.storage.onChanged.addListener((e,t)=>{if("local"===t&&e[s]){let t=e[s].newValue;console.log("Storage key ".concat(s," changed to ").concat(t)),c(t)}}),chrome.storage.local.get([s],e=>{let t=e[s];void 0!==t&&c(t)})})},[]),(0,l.useEffect)(()=>{if(e){let t=e.uid,s=(0,r.iH)(d,"Users/".concat(t));(0,r.jM)(s,e=>{let t=e.val();x(t)})}},[e]);let u=()=>{chrome.storage.local.get(["user"],e=>{let s=e.user;s?t(s):console.log("User not signed in")})},f=async()=>{let e=await chrome.runtime.sendMessage({message:"sign_in"});e.success&&u()},g=()=>(0,a.jsx)("div",{className:"w-full flex justify-center items-center px-10 h-16 border-b border-white border-opacity-5 text-white",children:e?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"rounded-full bg-secondary w-10 h-10 flex items-center justify-center mr-auto",children:(0,a.jsx)("img",{src:e.photoURL,className:"w-8 h-8 rounded-full"})})}):(0,a.jsx)("h1",{className:"text-xl font-medium",children:"Tracking Spanish"})}),w=()=>e&&(0,a.jsx)("div",{className:"w-full flex text-white border-t px-10 h-16 border-white border-opacity-5 "}),j=()=>{let e=new Date().toLocaleDateString().replace(/\./g,"-").replace(/\//g,"-").replace(/\[/g,"-").replace(/\]/g,"-"),t=m.watched_info[e]||0,s=Math.min(t/m.daily_goal*100,100),l=0;for(let e in m.watched_info)l+=m.watched_info[e];let n=(e=>{let t=Object.keys(e).sort(),s=0,a=0,l=null;return t.forEach(e=>{let t=new Date(e);if(l){let e=Math.abs(t.getTime()-l.getTime());1===Math.ceil(e/864e5)?a+=1:a=1}else a=1;s=Math.max(s,a),l=t}),Math.min(s,7)})(m.watched_info);return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("h2",{className:"text-xl mt-5 text-orange-400 font-medium",children:"Daily Progress"}),(0,a.jsxs)("h3",{className:"text-lg mt-3 text-white font-normal",children:[t," minutes"]}),(0,a.jsxs)("p",{className:"text-base mt-0 text-white font-normal opacity-30",children:["out of ",m.daily_goal," minutes goal"]}),(0,a.jsx)("div",{className:"w-full rounded-2xl bg-secondary h-5 mt-2 overflow-hidden",children:(0,a.jsx)("div",{style:{width:"".concat(s,"%"),transition:"width 1s ease-in-out"},className:"h-full bg-white"})}),(0,a.jsx)("h2",{className:"text-xl mt-10 text-orange-400 font-medium",children:"Total Watched"}),(0,a.jsx)("h1",{className:"text-5xl mt-3 text-white font-bold",children:(e=>{let t=Math.floor(e/60),s=e%60;return t>0?"".concat(t,"h ").concat(s,"m"):"".concat(s," minutes")})(l)}),(0,a.jsx)("h2",{className:"text-xl mt-10 text-orange-400 font-medium",children:"Days Practiced"}),(0,a.jsxs)("div",{className:"flex w-full items-center",children:[(0,a.jsx)("div",{className:"w-14 h-14 rounded-full bg-secondary flex items-center justify-center mt-3",children:(0,a.jsx)(i.l_V,{className:"text-white text-4xl "})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsxs)("h3",{className:"text-lg mt-3 text-white font-normal",children:[n," day".concat(n>1?"s":"")]}),(0,a.jsx)("p",{className:"text-base mt-0 text-white font-normal opacity-30",children:"out of a maximum of 7 days"})]}),(0,a.jsx)("h2",{className:"text-xl mt-10 text-orange-400 font-medium",children:"Day Calendar"})]})]})},N=()=>(0,a.jsx)("div",{className:"flex-grow w-full px-10 flex flex-col items-center ",children:e?(0,a.jsx)(a.Fragment,{children:"Stats"===o&&m&&(0,a.jsx)(j,{})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("button",{onClick:f,className:"bg-secondary px-4 py-2 rounded-md w-full border border-white border-opacity-5 text-white flex justify-center",children:(0,a.jsxs)("div",{className:"flex items-center text-lg font-sans",children:[(0,a.jsx)(n.csj,{className:"mr-5 text-xl"}),"Sign in with Google"]})})})});return(0,a.jsxs)("div",{className:"flex flex-col h-screen w-full bg-primary overflow-y-hidden",children:[(0,a.jsx)(g,{}),(0,a.jsx)(N,{}),(0,a.jsx)(w,{})]})}}},function(e){e.O(0,[768,627,318,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);
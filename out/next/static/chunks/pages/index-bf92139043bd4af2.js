(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2603)}])},2603:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(5893),l=s(7294),n=s(3692),r=s(3977),c=s(1019);let i=(0,r.ZF)({apiKey:"AIzaSyBU94yh1GICwAQbH6Sk1RvuJPrqlT4E2tA",databaseURL:"https://trackingspanish-default-rtdb.europe-west1.firebasedatabase.app"}),o=(0,c.N8)(i);function d(){let[e,t]=l.useState(null),[s,r]=l.useState(!1),[i,d]=l.useState("Stats"),[h,m]=l.useState(null);(0,l.useEffect)(()=>{u(),chrome.runtime.sendMessage({message:"POPUP_OPENED"}),chrome.windows.getCurrent(e=>{let t=e.id,s="watchingSpanish-".concat(t);chrome.storage.onChanged.addListener((e,t)=>{if("local"===t&&e[s]){let t=e[s].newValue;console.log("Storage key ".concat(s," changed to ").concat(t)),r(t)}}),chrome.storage.local.get([s],e=>{let t=e[s];void 0!==t&&r(t)})})},[]),(0,l.useEffect)(()=>{if(e){let t=e.uid,s=(0,c.iH)(o,"Users/".concat(t));(0,c.jM)(s,e=>{let t=e.val();m(t)})}},[e]);let u=()=>{chrome.storage.local.get(["user"],e=>{let s=e.user;s?t(s):console.log("User not signed in")})},x=async()=>{let e=await chrome.runtime.sendMessage({message:"sign_in"});e.success&&u()},f=()=>(0,a.jsx)("div",{className:"w-full flex justify-center items-center px-10 h-16 border-b border-white border-opacity-5 text-white",children:e?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"rounded-full bg-secondary w-10 h-10 flex items-center justify-center mr-auto",children:(0,a.jsx)("img",{src:e.photoURL,className:"w-8 h-8 rounded-full"})})}):(0,a.jsx)("h1",{className:"text-xl font-medium",children:"Tracking Spanish"})}),g=()=>e&&(0,a.jsx)("div",{className:"w-full flex text-white border-t px-10 h-16 border-white border-opacity-5 "}),w=()=>{let e=new Date().toLocaleDateString().replace(/\./g,"-").replace(/\//g,"-").replace(/\[/g,"-").replace(/\]/g,"-"),t=h.watched_info[e]||0,s=Math.min(t/h.daily_goal*100,100),l=0;for(let e in h.watched_info)l+=h.watched_info[e];let n=(e=>{let t=Object.keys(e).sort(),s=0,a=0,l=null;return t.forEach(e=>{let t=new Date(e);if(l){let e=Math.abs(t.getTime()-l.getTime());1===Math.ceil(e/864e5)?a+=1:a=1}else a=1;s=Math.max(s,a),l=t}),Math.min(s,7)})(h.watched_info);return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("h2",{className:"text-xl mt-5 text-orange-400 font-medium",children:"Daily Progress"}),(0,a.jsxs)("h3",{className:"text-lg mt-3 text-white font-normal",children:[t," minutes"]}),(0,a.jsxs)("p",{className:"text-base mt-0 text-white font-normal opacity-30",children:["out of ",h.daily_goal," minutes goal"]}),(0,a.jsx)("div",{className:"w-full rounded-2xl bg-secondary h-5 mt-2 overflow-hidden",children:(0,a.jsx)("div",{style:{width:"".concat(s,"%"),transition:"width 1s ease-in-out"},className:"h-full bg-white"})}),(0,a.jsx)("h2",{className:"text-xl mt-10 text-orange-400 font-medium",children:"Total Watched"}),(0,a.jsx)("h1",{className:"text-5xl mt-3 text-white font-bold",children:(e=>{let t=Math.floor(e/60),s=e%60;return t>0?"".concat(t,"h ").concat(s,"m"):"".concat(s," minutes")})(l)}),(0,a.jsx)("h2",{className:"text-xl mt-10 text-orange-400 font-medium",children:"Current Streak"}),(0,a.jsxs)("h3",{className:"text-lg mt-3 text-white font-normal",children:[n," days"]})]})},j=()=>(0,a.jsx)("div",{className:"flex-grow w-full px-10 flex flex-col items-center ",children:e?(0,a.jsx)(a.Fragment,{children:"Stats"===i&&h&&(0,a.jsx)(w,{})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("button",{onClick:x,className:"bg-secondary px-4 py-2 rounded-md w-full border border-white border-opacity-5 text-white flex justify-center",children:(0,a.jsxs)("div",{className:"flex items-center text-lg font-sans",children:[(0,a.jsx)(n.csj,{className:"mr-5 text-xl"}),"Sign in with Google"]})})})});return(0,a.jsxs)("div",{className:"flex flex-col h-screen w-full bg-primary overflow-y-hidden",children:[(0,a.jsx)(f,{}),(0,a.jsx)(j,{}),(0,a.jsx)(g,{})]})}}},function(e){e.O(0,[627,995,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);